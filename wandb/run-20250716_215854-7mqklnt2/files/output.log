Loaded datasets - Train: 400, Val: 50, Test: 50
=== DEBUG INFO ===
Sample data keys: ['y', 'root_node', 'has_cycles', 'edge_index', 'mask_strategy', 'num_edges', 'name', 'leaf_nodes', 'evidence_ids', 'num_nodes', 'x', 'edge_attr', 'evidence_vals', 'max_path_length', 'intermediate_nodes', 'mode']
Sample x shape: torch.Size([17, 17])
Sample y shape: torch.Size([1])
Sample y type: <class 'torch.Tensor'>
Sample y: tensor([0.0707])
Mode: root_probability
First 10 y shapes: [torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1])]

=== CLASS IMBALANCE DEBUG ===
Class 0: 193
Class 1: 207
Model config - Input: 17, Output: 1
Starting training...

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.9866, 0.6134, 0.6788, 0.3340, 0.1036, 0.4642, 0.2302, 0.2772, 0.9170,
        0.2459, 0.6943, 0.7569, 0.4457, 0.9922, 0.6566, 0.8513, 0.3101, 0.0717,
        0.6632, 0.6420, 0.1585, 0.5270, 0.2239, 0.3616, 0.7730, 0.0988, 0.7906,
        0.2816, 0.1122, 0.4700, 0.1356, 0.3022])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[-0.1004],
        [-0.0326],
        [-0.1072],
        [-0.0368],
        [-0.0112],
        [-0.0293],
        [-0.0734],
        [-0.1108],
        [-0.0815],
        [ 0.0373],
        [-0.0780],
        [-0.0450],
        [ 0.0587],
        [-0.1240],
        [-0.1276],
        [ 0.0398],
        [-0.0464],
        [-0.0512],
        [ 0.0335],
        [-0.0668],
        [-0.0284],
        [-0.0565],
        [-0.1144],
        [-0.0637],
        [-0.1556],
        [-0.1486],
        [-0.0166],
        [-0.0092],
        [-0.1469],
        [-0.0453],
        [-0.0269],
        [-0.0794]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.4749],
        [0.4918],
        [0.4732],
        [0.4908],
        [0.4972],
        [0.4927],
        [0.4817],
        [0.4723],
        [0.4796],
        [0.5093],
        [0.4805],
        [0.4887],
        [0.5147],
        [0.4690],
        [0.4681],
        [0.5099],
        [0.4884],
        [0.4872],
        [0.5084],
        [0.4833],
        [0.4929],
        [0.4859],
        [0.4714],
        [0.4841],
        [0.4612],
        [0.4629],
        [0.4959],
        [0.4977],
        [0.4633],
        [0.4887],
        [0.4933],
        [0.4802]], grad_fn=<SigmoidBackward0>)
Epoch 001 | Train Loss: 0.3293 | Val Loss: 0.2450
Validation loss decreased (inf --> 0.245000).  Saving model ...

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.0579, 0.3887, 0.6027, 0.8981, 0.6406, 0.7144, 0.6557, 0.3948, 0.5333,
        0.8865, 0.8679, 0.0645, 0.1181, 0.0988, 0.7457, 0.9770, 0.5738, 0.1442,
        0.3774, 0.3855, 0.9737, 0.7464, 0.6469, 0.0678, 0.3974, 0.6788, 0.2870,
        0.1307, 0.7585, 0.0525, 0.2459, 0.5591])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[ 0.1087],
        [ 0.1890],
        [ 0.2524],
        [ 0.0877],
        [-0.0221],
        [ 0.0456],
        [ 0.1514],
        [ 0.1742],
        [ 0.1724],
        [ 0.0373],
        [ 0.2765],
        [ 0.1213],
        [ 0.1416],
        [ 0.2773],
        [ 0.2153],
        [ 0.0770],
        [ 0.2992],
        [ 0.2849],
        [-0.0426],
        [ 0.0045],
        [ 0.0261],
        [ 0.1059],
        [ 0.2037],
        [ 0.2135],
        [ 0.0884],
        [ 0.0144],
        [ 0.1164],
        [ 0.0571],
        [ 0.1191],
        [ 0.1130],
        [ 0.2037],
        [ 0.0033]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.5271],
        [0.5471],
        [0.5628],
        [0.5219],
        [0.4945],
        [0.5114],
        [0.5378],
        [0.5434],
        [0.5430],
        [0.5093],
        [0.5687],
        [0.5303],
        [0.5353],
        [0.5689],
        [0.5536],
        [0.5192],
        [0.5742],
        [0.5707],
        [0.4893],
        [0.5011],
        [0.5065],
        [0.5264],
        [0.5508],
        [0.5532],
        [0.5221],
        [0.5036],
        [0.5291],
        [0.5143],
        [0.5298],
        [0.5282],
        [0.5508],
        [0.5008]], grad_fn=<SigmoidBackward0>)
Epoch 002 | Train Loss: 0.1910 | Val Loss: 0.1100
Validation loss decreased (0.245000 --> 0.110017).  Saving model ...

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.9548, 0.7290, 0.0120, 0.5446, 0.4790, 0.3836, 0.0954, 0.4872, 0.9258,
        0.0373, 0.6630, 0.1122, 0.5934, 0.1080, 0.3919, 0.0707, 0.2239, 0.2353,
        0.1894, 0.8674, 0.2500, 0.7838, 0.7643, 0.8576, 0.3023, 0.3101, 0.1181,
        0.4377, 0.4683, 0.9922, 0.7067, 0.6746])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.3442],
        [0.3602],
        [0.2112],
        [0.5436],
        [0.2547],
        [0.3922],
        [0.2448],
        [0.2859],
        [0.0803],
        [0.3746],
        [0.5279],
        [0.4210],
        [0.3281],
        [0.1320],
        [0.9209],
        [0.4797],
        [0.5975],
        [0.2534],
        [0.4714],
        [0.1397],
        [0.3763],
        [0.3297],
        [0.1235],
        [0.4324],
        [0.4737],
        [0.2908],
        [0.1860],
        [0.3451],
        [0.3765],
        [0.4347],
        [0.3876],
        [0.2442]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.5852],
        [0.5891],
        [0.5526],
        [0.6326],
        [0.5633],
        [0.5968],
        [0.5609],
        [0.5710],
        [0.5201],
        [0.5926],
        [0.6290],
        [0.6037],
        [0.5813],
        [0.5330],
        [0.7152],
        [0.6177],
        [0.6451],
        [0.5630],
        [0.6157],
        [0.5349],
        [0.5930],
        [0.5817],
        [0.5308],
        [0.6065],
        [0.6163],
        [0.5722],
        [0.5464],
        [0.5854],
        [0.5930],
        [0.6070],
        [0.5957],
        [0.5607]], grad_fn=<SigmoidBackward0>)
Epoch 003 | Train Loss: 0.1464 | Val Loss: 0.0902
Validation loss decreased (0.110017 --> 0.090167).  Saving model ...

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.6923, 0.9655, 0.9680, 0.2739, 0.6134, 0.2870, 0.1191, 0.4713, 0.9240,
        0.3022, 0.8375, 0.5884, 0.8112, 0.4269, 0.8744, 0.3296, 0.6889, 0.5026,
        0.0570, 0.8674, 0.7536, 0.2075, 0.0927, 0.1505, 0.0272, 0.1999, 0.3668,
        0.7226, 0.8865, 0.5895, 0.7404, 0.7015])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.5037],
        [0.4557],
        [0.4745],
        [0.3068],
        [0.7673],
        [0.1750],
        [0.3194],
        [0.7678],
        [0.5247],
        [0.3748],
        [0.4300],
        [0.6344],
        [0.3070],
        [0.4925],
        [0.6352],
        [0.4270],
        [0.3699],
        [0.7401],
        [0.1936],
        [0.4880],
        [0.3314],
        [0.1540],
        [0.4899],
        [0.4437],
        [0.6252],
        [0.7611],
        [0.2515],
        [0.7142],
        [0.5109],
        [0.5768],
        [0.3150],
        [0.7119]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.6233],
        [0.6120],
        [0.6165],
        [0.5761],
        [0.6829],
        [0.5436],
        [0.5792],
        [0.6830],
        [0.6282],
        [0.5926],
        [0.6059],
        [0.6535],
        [0.5762],
        [0.6207],
        [0.6537],
        [0.6051],
        [0.5914],
        [0.6770],
        [0.5483],
        [0.6196],
        [0.5821],
        [0.5384],
        [0.6201],
        [0.6091],
        [0.6514],
        [0.6816],
        [0.5625],
        [0.6713],
        [0.6250],
        [0.6403],
        [0.5781],
        [0.6708]], grad_fn=<SigmoidBackward0>)
Epoch 004 | Train Loss: 0.1187 | Val Loss: 0.1014
EarlyStopping counter: 1 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.8406, 0.2831, 0.5738, 0.7906, 0.8855, 0.7492, 0.3340, 0.8366, 0.7256,
        0.7259, 0.5797, 0.7542, 0.6973, 0.5041, 0.2949, 0.9756, 0.3230, 0.0182,
        0.6203, 0.6654, 0.1585, 0.4884, 0.2421, 0.1569, 0.5739, 0.7459, 0.9034,
        0.8663, 0.7087, 0.5857, 0.3214, 0.9076])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.3958],
        [0.4555],
        [0.5246],
        [0.6680],
        [0.2373],
        [0.5852],
        [0.4858],
        [0.5073],
        [0.3563],
        [0.2068],
        [0.4478],
        [0.7457],
        [0.3825],
        [0.6341],
        [0.7265],
        [0.2529],
        [0.2608],
        [0.4523],
        [0.3576],
        [0.5047],
        [0.4611],
        [0.4776],
        [0.5217],
        [0.2698],
        [0.3343],
        [0.6741],
        [0.3146],
        [0.3948],
        [0.9047],
        [0.3458],
        [0.2725],
        [0.6688]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.5977],
        [0.6120],
        [0.6282],
        [0.6610],
        [0.5591],
        [0.6423],
        [0.6191],
        [0.6242],
        [0.5881],
        [0.5515],
        [0.6101],
        [0.6782],
        [0.5945],
        [0.6534],
        [0.6740],
        [0.5629],
        [0.5648],
        [0.6112],
        [0.5885],
        [0.6236],
        [0.6133],
        [0.6172],
        [0.6275],
        [0.5670],
        [0.5828],
        [0.6624],
        [0.5780],
        [0.5974],
        [0.7119],
        [0.5856],
        [0.5677],
        [0.6612]], grad_fn=<SigmoidBackward0>)
Epoch 005 | Train Loss: 0.1200 | Val Loss: 0.0965
EarlyStopping counter: 2 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.2902, 0.0645, 0.6986, 0.7730, 0.0927, 0.3549, 0.1214, 0.3214, 0.8483,
        0.3527, 0.7179, 0.7730, 0.0179, 0.2239, 0.6659, 0.8513, 0.0873, 0.4486,
        0.3973, 0.9232, 0.1115, 0.5818, 0.7337, 0.3867, 0.3022, 0.4320, 0.1817,
        0.7328, 0.2831, 0.7144, 0.7074, 0.4872])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.3505],
        [0.2921],
        [0.4417],
        [0.3937],
        [0.4670],
        [0.5377],
        [0.4096],
        [0.2934],
        [0.7151],
        [0.4138],
        [0.5463],
        [0.4812],
        [0.6385],
        [0.4130],
        [0.5022],
        [0.4179],
        [0.3815],
        [0.6464],
        [0.2593],
        [0.5298],
        [0.3278],
        [0.3949],
        [0.5857],
        [0.2427],
        [0.2906],
        [0.6816],
        [0.5920],
        [0.5673],
        [0.4893],
        [0.3283],
        [0.5858],
        [0.4710]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.5868],
        [0.5725],
        [0.6087],
        [0.5972],
        [0.6147],
        [0.6313],
        [0.6010],
        [0.5728],
        [0.6715],
        [0.6020],
        [0.6333],
        [0.6180],
        [0.6544],
        [0.6018],
        [0.6230],
        [0.6030],
        [0.5942],
        [0.6562],
        [0.5645],
        [0.6294],
        [0.5812],
        [0.5975],
        [0.6424],
        [0.5604],
        [0.5721],
        [0.6641],
        [0.6438],
        [0.6381],
        [0.6199],
        [0.5814],
        [0.6424],
        [0.6156]], grad_fn=<SigmoidBackward0>)
Epoch 006 | Train Loss: 0.1120 | Val Loss: 0.0979
EarlyStopping counter: 3 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.4250, 0.3549, 0.7035, 0.6574, 0.7119, 0.3023, 0.0707, 0.8538, 0.3919,
        0.4716, 0.1442, 0.3214, 0.7259, 0.5026, 0.7508, 0.7838, 0.2772, 0.9191,
        0.8043, 0.1279, 0.0725, 0.6420, 0.8769, 0.9034, 0.8513, 0.8916, 0.6632,
        0.5446, 0.3275, 0.0330, 0.9575, 0.2373])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.3932],
        [0.5371],
        [0.3311],
        [0.2415],
        [0.2395],
        [0.6090],
        [0.4003],
        [0.5405],
        [0.3017],
        [0.2229],
        [0.4701],
        [0.5163],
        [0.4767],
        [0.4764],
        [0.4874],
        [0.6362],
        [0.4939],
        [0.6097],
        [0.7077],
        [0.4648],
        [0.3022],
        [0.5629],
        [0.6937],
        [0.3527],
        [0.7082],
        [0.3900],
        [0.5757],
        [0.5300],
        [0.3971],
        [0.2133],
        [0.7030],
        [0.5582]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.5970],
        [0.6311],
        [0.5820],
        [0.5601],
        [0.5596],
        [0.6477],
        [0.5988],
        [0.6319],
        [0.5749],
        [0.5555],
        [0.6154],
        [0.6263],
        [0.6170],
        [0.6169],
        [0.6195],
        [0.6539],
        [0.6210],
        [0.6479],
        [0.6699],
        [0.6141],
        [0.5750],
        [0.6371],
        [0.6668],
        [0.5873],
        [0.6700],
        [0.5963],
        [0.6401],
        [0.6295],
        [0.5980],
        [0.5531],
        [0.6689],
        [0.6360]], grad_fn=<SigmoidBackward0>)
Epoch 007 | Train Loss: 0.1075 | Val Loss: 0.0957
EarlyStopping counter: 4 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.0796, 0.8916, 0.8735, 0.6923, 0.7457, 0.1248, 0.7840, 0.7229, 0.2213,
        0.7354, 0.3919, 0.0118, 0.3214, 0.1356, 0.9635, 0.1122, 0.9034, 0.9893,
        0.1900, 0.8663, 0.1562, 0.0748, 0.9024, 0.5509, 0.1492, 0.6030, 0.5934,
        0.5098, 0.7542, 0.1214, 0.1225, 0.9737])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.3231],
        [0.6604],
        [0.4490],
        [0.4786],
        [0.3338],
        [0.3195],
        [0.4210],
        [0.3624],
        [0.4360],
        [0.7167],
        [0.5850],
        [0.5175],
        [0.4472],
        [0.6625],
        [0.5079],
        [0.6550],
        [0.3761],
        [0.6980],
        [0.4410],
        [0.5083],
        [0.4160],
        [0.4899],
        [0.5981],
        [0.7761],
        [0.4965],
        [0.6325],
        [0.2913],
        [0.5447],
        [0.6014],
        [0.3105],
        [0.5446],
        [0.4689]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.5801],
        [0.6593],
        [0.6104],
        [0.6174],
        [0.5827],
        [0.5792],
        [0.6037],
        [0.5896],
        [0.6073],
        [0.6719],
        [0.6422],
        [0.6266],
        [0.6100],
        [0.6598],
        [0.6243],
        [0.6581],
        [0.5929],
        [0.6678],
        [0.6085],
        [0.6244],
        [0.6025],
        [0.6201],
        [0.6452],
        [0.6848],
        [0.6216],
        [0.6531],
        [0.5723],
        [0.6329],
        [0.6460],
        [0.5770],
        [0.6329],
        [0.6151]], grad_fn=<SigmoidBackward0>)
Epoch 008 | Train Loss: 0.1122 | Val Loss: 0.0990
EarlyStopping counter: 5 out of 5
Early stopping triggered

Final Test Results:
Loss: 0.1152
MAE: 0.2970
RMSE: 0.3397
Model saved to models/graphsage_root_probability_root_only_intermediate.pt

=== CLASS IMBALANCE DEBUG ===
Class 0: 193
Class 1: 207
torch.Size([400])
