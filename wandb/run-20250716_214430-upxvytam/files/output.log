Loaded datasets - Train: 400, Val: 50, Test: 50
=== DEBUG INFO ===
Sample data keys: ['num_nodes', 'num_edges', 'has_cycles', 'root_node', 'edge_index', 'name', 'x', 'intermediate_nodes', 'mask_strategy', 'evidence_ids', 'leaf_nodes', 'max_path_length', 'evidence_vals', 'y', 'edge_attr', 'mode']
Sample x shape: torch.Size([17, 17])
Sample y shape: torch.Size([1])
Sample y type: <class 'torch.Tensor'>
Sample y: tensor([0.0707])
Mode: root_probability
First 10 y shapes: [torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1])]

=== CLASS IMBALANCE DEBUG ===
Class 0: 193
Class 1: 207
Model config - Input: 17, Output: 1
Starting training...

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.7824, 0.9423, 0.6986, 0.4204, 0.8347, 0.7337, 0.4700, 0.2816, 0.1441,
        0.3065, 0.6420, 0.5582, 0.5333, 0.8112, 0.4250, 0.1522, 0.9635, 0.7015,
        0.5339, 0.7354, 0.7328, 0.3668, 0.4486, 0.4884, 0.7643, 0.6203, 0.7749,
        0.6231, 0.3367, 0.1732, 0.9770, 0.2949])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[ 0.2845],
        [ 0.1452],
        [ 0.0738],
        [ 0.1043],
        [ 0.0088],
        [ 0.2022],
        [ 0.1904],
        [ 0.1048],
        [ 0.1443],
        [ 0.1553],
        [ 0.1896],
        [-0.0220],
        [ 0.2111],
        [ 0.2147],
        [ 0.0794],
        [ 0.0175],
        [ 0.1316],
        [ 0.1340],
        [-0.0372],
        [ 0.1519],
        [ 0.1495],
        [ 0.1165],
        [ 0.0608],
        [ 0.2837],
        [-0.0290],
        [ 0.1828],
        [ 0.1144],
        [ 0.1871],
        [ 0.1635],
        [ 0.1321],
        [ 0.1718],
        [ 0.2579]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.5707],
        [0.5362],
        [0.5185],
        [0.5260],
        [0.5022],
        [0.5504],
        [0.5475],
        [0.5262],
        [0.5360],
        [0.5387],
        [0.5473],
        [0.4945],
        [0.5526],
        [0.5535],
        [0.5198],
        [0.5044],
        [0.5329],
        [0.5334],
        [0.4907],
        [0.5379],
        [0.5373],
        [0.5291],
        [0.5152],
        [0.5705],
        [0.4927],
        [0.5456],
        [0.5286],
        [0.5466],
        [0.5408],
        [0.5330],
        [0.5428],
        [0.5641]], grad_fn=<SigmoidBackward0>)
Epoch 001 | Train Loss: 0.1550 | Val Loss: 0.0860
Validation loss decreased (inf --> 0.085952).  Saving model ...

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.9258, 0.7492, 0.7226, 0.3480, 0.6925, 0.7683, 0.1408, 0.8864, 0.2831,
        0.7936, 0.0927, 0.8735, 0.0645, 0.4872, 0.0717, 0.6406, 0.6409, 0.0897,
        0.8576, 0.2816, 0.5339, 0.7163, 0.7749, 0.3452, 0.7067, 0.6986, 0.0982,
        0.8067, 0.6557, 0.9549, 0.4999, 0.8663])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.5250],
        [0.2398],
        [0.4398],
        [0.4044],
        [0.5464],
        [0.2577],
        [0.4512],
        [0.6027],
        [0.3816],
        [0.4987],
        [0.4430],
        [0.3926],
        [0.2970],
        [0.2981],
        [0.3606],
        [0.4879],
        [0.4702],
        [0.3270],
        [0.3147],
        [0.2374],
        [0.4793],
        [0.4888],
        [0.4468],
        [0.4983],
        [0.3570],
        [0.6152],
        [0.3715],
        [0.2974],
        [0.3620],
        [0.4746],
        [0.5382],
        [0.2885]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.6283],
        [0.5597],
        [0.6082],
        [0.5997],
        [0.6333],
        [0.5641],
        [0.6109],
        [0.6463],
        [0.5943],
        [0.6222],
        [0.6090],
        [0.5969],
        [0.5737],
        [0.5740],
        [0.5892],
        [0.6196],
        [0.6154],
        [0.5810],
        [0.5780],
        [0.5591],
        [0.6176],
        [0.6198],
        [0.6099],
        [0.6221],
        [0.5883],
        [0.6491],
        [0.5918],
        [0.5738],
        [0.5895],
        [0.6165],
        [0.6314],
        [0.5716]], grad_fn=<SigmoidBackward0>)
Epoch 002 | Train Loss: 0.1041 | Val Loss: 0.0858
Validation loss decreased (0.085952 --> 0.085809).  Saving model ...

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.4713, 0.1036, 0.8308, 0.4250, 0.6742, 0.8043, 0.7803, 0.8354, 0.3836,
        0.7290, 0.0223, 0.5041, 0.1782, 0.9575, 0.3527, 0.1999, 0.0283, 0.9548,
        0.8916, 0.6184, 0.2421, 0.2239, 0.8483, 0.0373, 0.2946, 0.1748, 0.5026,
        0.4902, 0.8375, 0.3973, 0.5227, 0.7045])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.5705],
        [0.4941],
        [0.5730],
        [0.3863],
        [0.5134],
        [0.4780],
        [0.4212],
        [0.4852],
        [0.6811],
        [0.4982],
        [0.5457],
        [0.7659],
        [0.6682],
        [0.5598],
        [0.4448],
        [0.4730],
        [0.5886],
        [0.6853],
        [0.4177],
        [0.7022],
        [0.7144],
        [0.5898],
        [0.5160],
        [0.7021],
        [0.7265],
        [0.6277],
        [0.5124],
        [0.6671],
        [0.6225],
        [0.7225],
        [0.5822],
        [0.3897]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.6389],
        [0.6211],
        [0.6395],
        [0.5954],
        [0.6256],
        [0.6173],
        [0.6038],
        [0.6190],
        [0.6640],
        [0.6220],
        [0.6331],
        [0.6826],
        [0.6611],
        [0.6364],
        [0.6094],
        [0.6161],
        [0.6430],
        [0.6649],
        [0.6029],
        [0.6687],
        [0.6714],
        [0.6433],
        [0.6262],
        [0.6686],
        [0.6740],
        [0.6520],
        [0.6254],
        [0.6609],
        [0.6508],
        [0.6731],
        [0.6416],
        [0.5962]], grad_fn=<SigmoidBackward0>)
Epoch 003 | Train Loss: 0.1026 | Val Loss: 0.0836
Validation loss decreased (0.085809 --> 0.083594).  Saving model ...

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.3836, 0.4884, 0.7337, 0.8393, 0.4763, 0.8142, 0.6268, 0.5818, 0.8130,
        0.7492, 0.1505, 0.6742, 0.1307, 0.3367, 0.6740, 0.3974, 0.2152, 0.1017,
        0.9403, 0.5588, 0.5270, 0.9264, 0.5041, 0.7683, 0.6046, 0.1080, 0.7144,
        0.7936, 0.3480, 0.7074, 0.7256, 0.4747])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.6242],
        [0.4935],
        [0.4525],
        [0.4821],
        [0.3490],
        [0.5551],
        [0.4102],
        [0.4205],
        [0.5464],
        [0.4500],
        [0.5895],
        [0.6333],
        [0.4425],
        [0.3128],
        [0.4573],
        [0.4966],
        [0.5204],
        [0.5632],
        [0.5827],
        [0.3242],
        [0.4587],
        [0.3984],
        [0.3696],
        [0.4840],
        [0.5449],
        [0.5387],
        [0.4776],
        [0.4561],
        [0.4748],
        [0.6409],
        [0.5530],
        [0.5719]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.6512],
        [0.6209],
        [0.6112],
        [0.6182],
        [0.5864],
        [0.6353],
        [0.6011],
        [0.6036],
        [0.6333],
        [0.6106],
        [0.6432],
        [0.6532],
        [0.6089],
        [0.5776],
        [0.6124],
        [0.6217],
        [0.6272],
        [0.6372],
        [0.6417],
        [0.5803],
        [0.6127],
        [0.5983],
        [0.5914],
        [0.6187],
        [0.6330],
        [0.6315],
        [0.6172],
        [0.6121],
        [0.6165],
        [0.6550],
        [0.6348],
        [0.6392]], grad_fn=<SigmoidBackward0>)
Epoch 004 | Train Loss: 0.1066 | Val Loss: 0.0847
EarlyStopping counter: 1 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.9209, 0.3527, 0.7819, 0.0393, 0.7657, 0.1999, 0.3023, 0.3452, 0.5281,
        0.5884, 0.7730, 0.0605, 0.4303, 0.7683, 0.0525, 0.2479, 0.6406, 0.1441,
        0.7643, 0.7803, 0.1115, 0.3948, 0.0120, 0.7486, 0.8003, 0.7967, 0.8981,
        0.5395, 0.9300, 0.6744, 0.8476, 0.0283])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.5548],
        [0.3264],
        [0.4179],
        [0.4078],
        [0.4971],
        [0.4739],
        [0.5709],
        [0.3994],
        [0.5165],
        [0.6163],
        [0.5169],
        [0.5487],
        [0.4850],
        [0.5380],
        [0.4210],
        [0.5921],
        [0.4285],
        [0.5825],
        [0.2640],
        [0.3847],
        [0.3685],
        [0.5439],
        [0.5290],
        [0.4857],
        [0.4837],
        [0.3364],
        [0.5789],
        [0.2635],
        [0.4529],
        [0.5663],
        [0.3898],
        [0.3093]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.6353],
        [0.5809],
        [0.6030],
        [0.6006],
        [0.6218],
        [0.6163],
        [0.6390],
        [0.5985],
        [0.6263],
        [0.6494],
        [0.6264],
        [0.6338],
        [0.6189],
        [0.6314],
        [0.6037],
        [0.6439],
        [0.6055],
        [0.6417],
        [0.5656],
        [0.5950],
        [0.5911],
        [0.6327],
        [0.6293],
        [0.6191],
        [0.6186],
        [0.5833],
        [0.6408],
        [0.5655],
        [0.6113],
        [0.6379],
        [0.5962],
        [0.5767]], grad_fn=<SigmoidBackward0>)
Epoch 005 | Train Loss: 0.0984 | Val Loss: 0.0840
EarlyStopping counter: 2 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.5337, 0.1144, 0.5698, 0.1102, 0.3065, 0.8400, 0.8581, 0.7585, 0.1191,
        0.1817, 0.2295, 0.2373, 0.5582, 0.0629, 0.8003, 0.0330, 0.6184, 0.8744,
        0.8618, 0.6420, 0.3948, 0.0525, 0.9232, 0.7508, 0.7035, 0.7768, 0.9548,
        0.3480, 0.2232, 0.2949, 0.8880, 0.4982])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.5024],
        [0.4250],
        [0.5178],
        [0.3921],
        [0.4519],
        [0.4784],
        [0.3939],
        [0.6172],
        [0.5521],
        [0.4796],
        [0.3626],
        [0.4885],
        [0.6583],
        [0.3483],
        [0.3784],
        [0.6084],
        [0.5013],
        [0.4389],
        [0.4830],
        [0.5639],
        [0.4758],
        [0.6193],
        [0.5813],
        [0.6057],
        [0.5282],
        [0.5808],
        [0.4530],
        [0.5845],
        [0.4032],
        [0.3939],
        [0.5111],
        [0.5826]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.6230],
        [0.6047],
        [0.6266],
        [0.5968],
        [0.6111],
        [0.6174],
        [0.5972],
        [0.6496],
        [0.6346],
        [0.6177],
        [0.5897],
        [0.6197],
        [0.6589],
        [0.5862],
        [0.5935],
        [0.6476],
        [0.6228],
        [0.6080],
        [0.6185],
        [0.6374],
        [0.6168],
        [0.6501],
        [0.6414],
        [0.6470],
        [0.6291],
        [0.6412],
        [0.6114],
        [0.6421],
        [0.5995],
        [0.5972],
        [0.6251],
        [0.6417]], grad_fn=<SigmoidBackward0>)
Epoch 006 | Train Loss: 0.1000 | Val Loss: 0.0842
EarlyStopping counter: 3 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.7077, 0.0069, 0.4912, 0.0605, 0.6289, 0.7657, 0.5339, 0.8880, 0.2239,
        0.9034, 0.3527, 0.4204, 0.1817, 0.6566, 0.8347, 0.7337, 0.2047, 0.7967,
        0.6268, 0.5337, 0.2949, 0.5895, 0.0580, 0.6659, 0.1225, 0.7163, 0.4561,
        0.7397, 0.0133, 0.0262, 0.6319, 0.2152])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.5723],
        [0.4069],
        [0.6073],
        [0.6320],
        [0.4986],
        [0.3199],
        [0.4680],
        [0.5189],
        [0.3856],
        [0.5345],
        [0.3630],
        [0.4421],
        [0.4192],
        [0.4392],
        [0.5321],
        [0.3689],
        [0.6019],
        [0.4251],
        [0.4005],
        [0.4855],
        [0.5675],
        [0.5512],
        [0.5768],
        [0.5935],
        [0.4258],
        [0.4854],
        [0.5395],
        [0.4175],
        [0.5092],
        [0.6564],
        [0.5102],
        [0.3891]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.6393],
        [0.6004],
        [0.6473],
        [0.6529],
        [0.6221],
        [0.5793],
        [0.6149],
        [0.6269],
        [0.5952],
        [0.6305],
        [0.5898],
        [0.6088],
        [0.6033],
        [0.6081],
        [0.6300],
        [0.5912],
        [0.6461],
        [0.6047],
        [0.5988],
        [0.6190],
        [0.6382],
        [0.6344],
        [0.6403],
        [0.6442],
        [0.6049],
        [0.6190],
        [0.6317],
        [0.6029],
        [0.6246],
        [0.6585],
        [0.6248],
        [0.5961]], grad_fn=<SigmoidBackward0>)
Epoch 007 | Train Loss: 0.1014 | Val Loss: 0.0843
EarlyStopping counter: 4 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.8375, 0.4872, 0.8538, 0.4397, 0.1485, 0.3774, 0.6716, 0.7569, 0.2459,
        0.2586, 0.4303, 0.0579, 0.3452, 0.2295, 0.0393, 0.1225, 0.4790, 0.1638,
        0.1569, 0.7730, 0.5337, 0.7542, 0.7906, 0.2902, 0.7015, 0.2597, 0.8865,
        0.9034, 0.4457, 0.3023, 0.9258, 0.8864])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.5514],
        [0.5150],
        [0.3723],
        [0.5580],
        [0.5163],
        [0.5017],
        [0.4987],
        [0.4296],
        [0.4198],
        [0.4208],
        [0.5511],
        [0.3268],
        [0.5150],
        [0.3774],
        [0.4303],
        [0.5654],
        [0.5986],
        [0.5656],
        [0.5545],
        [0.4917],
        [0.5625],
        [0.4974],
        [0.5524],
        [0.4325],
        [0.5303],
        [0.4131],
        [0.5170],
        [0.5281],
        [0.5718],
        [0.4949],
        [0.6150],
        [0.3723]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.6345],
        [0.6260],
        [0.5920],
        [0.6360],
        [0.6263],
        [0.6229],
        [0.6222],
        [0.6058],
        [0.6034],
        [0.6037],
        [0.6344],
        [0.5810],
        [0.6260],
        [0.5932],
        [0.6060],
        [0.6377],
        [0.6453],
        [0.6377],
        [0.6352],
        [0.6205],
        [0.6370],
        [0.6219],
        [0.6347],
        [0.6065],
        [0.6296],
        [0.6018],
        [0.6264],
        [0.6290],
        [0.6392],
        [0.6213],
        [0.6491],
        [0.5920]], grad_fn=<SigmoidBackward0>)
Epoch 008 | Train Loss: 0.1019 | Val Loss: 0.0857
EarlyStopping counter: 5 out of 5
Early stopping triggered

Final Test Results:
Loss: 0.0914
MAE: 0.2631
RMSE: 0.3024
Model saved to models/graphsage_root_probability_both_intermediate.pt

=== CLASS IMBALANCE DEBUG ===
Class 0: 193
Class 1: 207
torch.Size([400])
