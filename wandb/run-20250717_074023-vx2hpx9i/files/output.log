Loaded datasets - Train: 400, Val: 50, Test: 50
=== DEBUG INFO ===
Sample data keys: ['intermediate_nodes', 'num_nodes', 'evidence_vals', 'mode', 'mask_strategy', 'evidence_ids', 'num_edges', 'root_node', 'name', 'has_cycles', 'max_path_length', 'leaf_nodes', 'y', 'x', 'edge_attr', 'edge_index']
Sample x shape: torch.Size([17, 17])
Sample y shape: torch.Size([1])
Sample y type: <class 'torch.Tensor'>
Sample y: tensor([0.0707])
Mode: root_probability
First 10 y shapes: [torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1])]

=== CLASS IMBALANCE DEBUG ===
Class 0: 193
Class 1: 207
Model config - Input: 17, Output: 1
Starting training...

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.1782, 0.5227, 0.0218, 0.8464, 0.8875, 0.6319, 0.8735, 0.8513, 0.1408,
        0.3367, 0.0525, 0.9423, 0.0262, 0.4700, 0.0264, 0.6268, 0.7976, 0.7179,
        0.1562, 0.1122, 0.1225, 0.6566, 0.8168, 0.7035, 0.5270, 0.0988, 0.9655,
        0.0629, 0.7486, 0.6630, 0.9737, 0.7936])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[ 0.0350],
        [ 0.1587],
        [-0.0089],
        [ 0.1083],
        [ 0.1149],
        [ 0.0985],
        [ 0.0445],
        [ 0.2181],
        [ 0.0912],
        [ 0.1645],
        [ 0.0808],
        [-0.0313],
        [ 0.0873],
        [ 0.0878],
        [ 0.0309],
        [ 0.2368],
        [ 0.1419],
        [ 0.0794],
        [ 0.1191],
        [-0.0183],
        [ 0.1650],
        [ 0.0104],
        [ 0.0868],
        [ 0.0733],
        [ 0.2209],
        [ 0.1399],
        [ 0.1021],
        [ 0.0924],
        [ 0.1023],
        [ 0.1119],
        [ 0.1134],
        [ 0.0959]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.5087],
        [0.5396],
        [0.4978],
        [0.5270],
        [0.5287],
        [0.5246],
        [0.5111],
        [0.5543],
        [0.5228],
        [0.5410],
        [0.5202],
        [0.4922],
        [0.5218],
        [0.5219],
        [0.5077],
        [0.5589],
        [0.5354],
        [0.5198],
        [0.5297],
        [0.4954],
        [0.5412],
        [0.5026],
        [0.5217],
        [0.5183],
        [0.5550],
        [0.5349],
        [0.5255],
        [0.5231],
        [0.5256],
        [0.5279],
        [0.5283],
        [0.5240]], grad_fn=<SigmoidBackward0>)
Target y: tensor([0.1782, 0.5227, 0.0218, 0.8464, 0.8875, 0.6319, 0.8735, 0.8513, 0.1408,
        0.3367])
Epoch 001 | Train Loss: 0.1732 | Val Loss: 0.1024
Validation loss decreased (inf --> 0.102443).  Saving model ...

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.7542, 0.0580, 0.9608, 0.1225, 0.1214, 0.5333, 0.6744, 0.3582, 0.0672,
        0.1387, 0.8513, 0.1369, 0.7337, 0.4763, 0.0416, 0.7457, 0.8067, 0.3480,
        0.3101, 0.5446, 0.7179, 0.5710, 0.7074, 0.6740, 0.8875, 0.4982, 0.0228,
        0.9922, 0.5591, 0.0373, 0.7459, 0.1638])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.3324],
        [0.4231],
        [0.4629],
        [0.4611],
        [0.5429],
        [0.3336],
        [0.5627],
        [0.2857],
        [0.5289],
        [0.4509],
        [0.3718],
        [0.2584],
        [0.5233],
        [0.5062],
        [0.3979],
        [0.3160],
        [0.3532],
        [0.3462],
        [0.2262],
        [0.4607],
        [0.3744],
        [0.3668],
        [0.3143],
        [0.5798],
        [0.4694],
        [0.3316],
        [0.4575],
        [0.3949],
        [0.2749],
        [0.4666],
        [0.4972],
        [0.3165]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.5823],
        [0.6042],
        [0.6137],
        [0.6133],
        [0.6325],
        [0.5826],
        [0.6371],
        [0.5709],
        [0.6292],
        [0.6108],
        [0.5919],
        [0.5642],
        [0.6279],
        [0.6239],
        [0.5982],
        [0.5783],
        [0.5874],
        [0.5857],
        [0.5563],
        [0.6132],
        [0.5925],
        [0.5907],
        [0.5779],
        [0.6410],
        [0.6152],
        [0.5822],
        [0.6124],
        [0.5975],
        [0.5683],
        [0.6146],
        [0.6218],
        [0.5785]], grad_fn=<SigmoidBackward0>)
Target y: tensor([0.7542, 0.0580, 0.9608, 0.1225, 0.1214, 0.5333, 0.6744, 0.3582, 0.0672,
        0.1387])
Epoch 002 | Train Loss: 0.1119 | Val Loss: 0.0835
Validation loss decreased (0.102443 --> 0.083495).  Saving model ...

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.5339, 0.8400, 0.5395, 0.0796, 0.0570, 0.9770, 0.0228, 0.8197, 0.9548,
        0.8855, 0.4764, 0.5698, 0.7730, 0.6943, 0.5591, 0.4961, 0.0262, 0.3134,
        0.1748, 0.9549, 0.0672, 0.0218, 0.7464, 0.1050, 0.7229, 0.7585, 0.4269,
        0.8576, 0.2949, 0.8142, 0.7119, 0.2484])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.5455],
        [0.5125],
        [0.4002],
        [0.4862],
        [0.3960],
        [0.3652],
        [0.3670],
        [0.5448],
        [0.5293],
        [0.4044],
        [0.5462],
        [0.5121],
        [0.4788],
        [0.6220],
        [0.5199],
        [0.4558],
        [0.6298],
        [0.5665],
        [0.4404],
        [0.4304],
        [0.7872],
        [0.6717],
        [0.5180],
        [0.4379],
        [0.5480],
        [0.6489],
        [0.7024],
        [0.3248],
        [0.5679],
        [0.4617],
        [0.3500],
        [0.4493]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.6331],
        [0.6254],
        [0.5987],
        [0.6192],
        [0.5977],
        [0.5903],
        [0.5907],
        [0.6329],
        [0.6293],
        [0.5997],
        [0.6333],
        [0.6253],
        [0.6175],
        [0.6507],
        [0.6271],
        [0.6120],
        [0.6524],
        [0.6380],
        [0.6083],
        [0.6060],
        [0.6872],
        [0.6619],
        [0.6267],
        [0.6078],
        [0.6337],
        [0.6568],
        [0.6687],
        [0.5805],
        [0.6383],
        [0.6134],
        [0.5866],
        [0.6105]], grad_fn=<SigmoidBackward0>)
Target y: tensor([0.5339, 0.8400, 0.5395, 0.0796, 0.0570, 0.9770, 0.0228, 0.8197, 0.9548,
        0.8855])
Epoch 003 | Train Loss: 0.1173 | Val Loss: 0.0910
EarlyStopping counter: 1 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.0645, 0.8176, 0.1569, 0.0285, 0.2742, 0.6716, 0.9486, 0.1287, 0.0439,
        0.9232, 0.0897, 0.9024, 0.7328, 0.0218, 0.8581, 0.8663, 0.3022, 0.7976,
        0.8149, 0.4457, 0.7749, 0.6923, 0.8400, 0.6268, 0.6973, 0.5797, 0.8743,
        0.8375, 0.2302, 0.0179, 0.5395, 0.1102])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.3346],
        [0.3888],
        [0.5085],
        [0.2927],
        [0.5844],
        [0.5505],
        [0.2637],
        [0.3432],
        [0.4488],
        [0.4393],
        [0.3937],
        [0.3192],
        [0.2857],
        [0.3585],
        [0.3693],
        [0.3672],
        [0.4575],
        [0.4331],
        [0.4647],
        [0.4148],
        [0.4681],
        [0.5870],
        [0.4370],
        [0.4654],
        [0.4760],
        [0.4421],
        [0.4112],
        [0.4252],
        [0.3366],
        [0.4280],
        [0.3426],
        [0.4325]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.5829],
        [0.5960],
        [0.6245],
        [0.5726],
        [0.6421],
        [0.6343],
        [0.5655],
        [0.5850],
        [0.6104],
        [0.6081],
        [0.5972],
        [0.5791],
        [0.5709],
        [0.5887],
        [0.5913],
        [0.5908],
        [0.6124],
        [0.6066],
        [0.6141],
        [0.6022],
        [0.6149],
        [0.6427],
        [0.6076],
        [0.6143],
        [0.6168],
        [0.6088],
        [0.6014],
        [0.6047],
        [0.5834],
        [0.6054],
        [0.5848],
        [0.6065]], grad_fn=<SigmoidBackward0>)
Target y: tensor([0.0645, 0.8176, 0.1569, 0.0285, 0.2742, 0.6716, 0.9486, 0.1287, 0.0439,
        0.9232])
Epoch 004 | Train Loss: 0.1036 | Val Loss: 0.0903
EarlyStopping counter: 2 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.0678, 0.7256, 0.5739, 0.9737, 0.4303, 0.1225, 0.0264, 0.8366, 0.8085,
        0.0592, 0.7226, 0.8581, 0.1279, 0.6923, 0.8176, 0.4999, 0.2772, 0.7657,
        0.1441, 0.4269, 0.9922, 0.5452, 0.4204, 0.8769, 0.0272, 0.8483, 0.4397,
        0.8067, 0.6788, 0.8743, 0.0725, 0.2353])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.3623],
        [0.3634],
        [0.3367],
        [0.4030],
        [0.3116],
        [0.3886],
        [0.4416],
        [0.5110],
        [0.4195],
        [0.4334],
        [0.4050],
        [0.4350],
        [0.3757],
        [0.5167],
        [0.4384],
        [0.3095],
        [0.5498],
        [0.3855],
        [0.3411],
        [0.5073],
        [0.6333],
        [0.4457],
        [0.4702],
        [0.3913],
        [0.4427],
        [0.4169],
        [0.5438],
        [0.3239],
        [0.4577],
        [0.4678],
        [0.4822],
        [0.3515]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.5896],
        [0.5899],
        [0.5834],
        [0.5994],
        [0.5773],
        [0.5960],
        [0.6086],
        [0.6250],
        [0.6034],
        [0.6067],
        [0.5999],
        [0.6071],
        [0.5928],
        [0.6264],
        [0.6079],
        [0.5768],
        [0.6341],
        [0.5952],
        [0.5845],
        [0.6242],
        [0.6532],
        [0.6096],
        [0.6154],
        [0.5966],
        [0.6089],
        [0.6027],
        [0.6327],
        [0.5803],
        [0.6125],
        [0.6149],
        [0.6183],
        [0.5870]], grad_fn=<SigmoidBackward0>)
Target y: tensor([0.0678, 0.7256, 0.5739, 0.9737, 0.4303, 0.1225, 0.0264, 0.8366, 0.8085,
        0.0592])
Epoch 005 | Train Loss: 0.1022 | Val Loss: 0.0861
EarlyStopping counter: 3 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.8865, 0.0982, 0.9191, 0.8043, 0.1369, 0.5337, 0.9258, 0.0742, 0.0330,
        0.1999, 0.9549, 0.7921, 0.2677, 0.3214, 0.4377, 0.9988, 0.1122, 0.7323,
        0.2772, 0.7840, 0.4642, 0.1638, 0.7226, 0.8618, 0.0796, 0.7457, 0.3480,
        0.0510, 0.9642, 0.8538, 0.2500, 0.7768])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.3459],
        [0.5058],
        [0.4872],
        [0.6288],
        [0.5696],
        [0.4476],
        [0.5980],
        [0.3690],
        [0.4795],
        [0.6625],
        [0.4017],
        [0.5002],
        [0.3912],
        [0.5141],
        [0.4864],
        [0.4634],
        [0.4292],
        [0.5383],
        [0.5665],
        [0.4318],
        [0.4703],
        [0.5179],
        [0.3980],
        [0.4013],
        [0.6768],
        [0.4851],
        [0.5107],
        [0.4223],
        [0.5614],
        [0.5203],
        [0.4401],
        [0.5460]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.5856],
        [0.6238],
        [0.6194],
        [0.6522],
        [0.6387],
        [0.6101],
        [0.6452],
        [0.5912],
        [0.6176],
        [0.6598],
        [0.5991],
        [0.6225],
        [0.5966],
        [0.6258],
        [0.6193],
        [0.6138],
        [0.6057],
        [0.6314],
        [0.6380],
        [0.6063],
        [0.6155],
        [0.6267],
        [0.5982],
        [0.5990],
        [0.6630],
        [0.6190],
        [0.6250],
        [0.6040],
        [0.6368],
        [0.6272],
        [0.6083],
        [0.6332]], grad_fn=<SigmoidBackward0>)
Target y: tensor([0.8865, 0.0982, 0.9191, 0.8043, 0.1369, 0.5337, 0.9258, 0.0742, 0.0330,
        0.1999])
Epoch 006 | Train Loss: 0.0976 | Val Loss: 0.0882
EarlyStopping counter: 4 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.8373, 0.7921, 0.9423, 0.4790, 0.4961, 0.3480, 0.6716, 0.3668, 0.2373,
        0.1181, 0.9232, 0.1642, 0.8476, 0.2677, 0.7226, 0.7569, 0.7585, 0.8865,
        0.7824, 0.9922, 0.4747, 0.1122, 0.6923, 0.5797, 0.0283, 0.7936, 0.4642,
        0.6468, 0.7730, 0.1102, 0.9655, 0.9770])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.4253],
        [0.4338],
        [0.3957],
        [0.3907],
        [0.5586],
        [0.5062],
        [0.3789],
        [0.4638],
        [0.3349],
        [0.3549],
        [0.5792],
        [0.5933],
        [0.5372],
        [0.5087],
        [0.3309],
        [0.3621],
        [0.3899],
        [0.4368],
        [0.6651],
        [0.4993],
        [0.5565],
        [0.5393],
        [0.4765],
        [0.4066],
        [0.3877],
        [0.4273],
        [0.4436],
        [0.3017],
        [0.3598],
        [0.5155],
        [0.3840],
        [0.5625]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.6048],
        [0.6068],
        [0.5977],
        [0.5964],
        [0.6361],
        [0.6239],
        [0.5936],
        [0.6139],
        [0.5830],
        [0.5878],
        [0.6409],
        [0.6441],
        [0.6312],
        [0.6245],
        [0.5820],
        [0.5896],
        [0.5962],
        [0.6075],
        [0.6604],
        [0.6223],
        [0.6356],
        [0.6316],
        [0.6169],
        [0.6003],
        [0.5957],
        [0.6052],
        [0.6091],
        [0.5748],
        [0.5890],
        [0.6261],
        [0.5948],
        [0.6370]], grad_fn=<SigmoidBackward0>)
Target y: tensor([0.8373, 0.7921, 0.9423, 0.4790, 0.4961, 0.3480, 0.6716, 0.3668, 0.2373,
        0.1181])
Epoch 007 | Train Loss: 0.1042 | Val Loss: 0.0878
EarlyStopping counter: 5 out of 5
Early stopping triggered

Final Test Results:
Loss: 0.0962
MAE: 0.2708
RMSE: 0.3102
Model saved to models/graphsage_root_probability_root_only_intermediate.pt

=== CLASS IMBALANCE DEBUG ===
Class 0: 193
Class 1: 207
torch.Size([400])
