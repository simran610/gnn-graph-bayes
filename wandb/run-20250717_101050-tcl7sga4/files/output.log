Loaded datasets - Train: 400, Val: 50, Test: 50
=== DEBUG INFO ===
Sample data keys: ['name', 'edge_index', 'num_edges', 'num_nodes', 'leaf_nodes', 'max_path_length', 'x', 'root_node', 'mask_strategy', 'evidence_ids', 'intermediate_nodes', 'has_cycles', 'evidence_vals', 'y', 'edge_attr', 'mode']
Sample x shape: torch.Size([17, 17])
Sample y shape: torch.Size([1])
Sample y type: <class 'torch.Tensor'>
Sample y: tensor([0.0707])
Mode: root_probability
First 10 y shapes: [torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1])]

=== CLASS IMBALANCE DEBUG ===
Class 0: 193
Class 1: 207
Model config - Input: 17, Output: 1
Starting training...

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.2739, 0.9034, 0.8130, 0.9549, 0.9575, 0.9988, 0.9548, 0.7824, 0.6746,
        0.4204, 0.2946, 0.7459, 0.2816, 0.0672, 0.1442, 0.8880, 0.7536, 0.8067,
        0.8082, 0.0748, 0.2605, 0.7256, 0.5591, 0.9655, 0.6468, 0.6659, 0.8375,
        0.7622, 0.3887, 0.8043, 0.2353, 0.8366])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.2598],
        [0.2374],
        [0.2419],
        [0.1740],
        [0.3231],
        [0.1982],
        [0.2631],
        [0.2283],
        [0.1451],
        [0.1508],
        [0.2556],
        [0.2294],
        [0.2503],
        [0.2937],
        [0.1690],
        [0.1892],
        [0.2215],
        [0.2035],
        [0.1916],
        [0.1936],
        [0.2201],
        [0.2454],
        [0.1835],
        [0.2443],
        [0.2010],
        [0.2593],
        [0.2258],
        [0.2300],
        [0.2649],
        [0.1860],
        [0.2019],
        [0.2112]], grad_fn=<StackBackward0>)
Target y: tensor([0.2739, 0.9034, 0.8130, 0.9549, 0.9575, 0.9988, 0.9548, 0.7824, 0.6746,
        0.4204])
Epoch 001 | Train Loss: 0.1461 | Val Loss: 0.1162
Validation loss decreased (inf --> 0.116209).  Saving model ...

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.7256, 0.5591, 0.1033, 0.5857, 0.7179, 0.5395, 0.2047, 0.9737, 0.6630,
        0.7486, 0.1136, 0.1585, 0.6566, 0.8168, 0.2479, 0.1871, 0.4700, 0.8043,
        0.0373, 0.7749, 0.8375, 0.9642, 0.5026, 0.7730, 0.3527, 0.7087, 0.0330,
        0.7542, 0.3855, 0.9462, 0.1492, 0.6716])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.3228],
        [0.3582],
        [0.4206],
        [0.4521],
        [0.3254],
        [0.3480],
        [0.4147],
        [0.5168],
        [0.4199],
        [0.4908],
        [0.4094],
        [0.2329],
        [0.4820],
        [0.2940],
        [0.3191],
        [0.3563],
        [0.3937],
        [0.4265],
        [0.3066],
        [0.3494],
        [0.5847],
        [0.3848],
        [0.4819],
        [0.3955],
        [0.3726],
        [0.2456],
        [0.3137],
        [0.4335],
        [0.4184],
        [0.3909],
        [0.3402],
        [0.3310]], grad_fn=<StackBackward0>)
Target y: tensor([0.7256, 0.5591, 0.1033, 0.5857, 0.7179, 0.5395, 0.2047, 0.9737, 0.6630,
        0.7486])
Epoch 002 | Train Loss: 0.1050 | Val Loss: 0.0886
Validation loss decreased (0.116209 --> 0.088637).  Saving model ...

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.9240, 0.3214, 0.7464, 0.6557, 0.3527, 0.4377, 0.6469, 0.7730, 0.1522,
        0.5738, 0.1080, 0.7035, 0.1225, 0.8916, 0.6923, 0.5588, 0.8354, 0.2597,
        0.6420, 0.4303, 0.8865, 0.0120, 0.7622, 0.8538, 0.9635, 0.6030, 0.7542,
        0.9034, 0.6632, 0.0580, 0.1642, 0.8067])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.4265],
        [0.5178],
        [0.4185],
        [0.4928],
        [0.4445],
        [0.4055],
        [0.4216],
        [0.6030],
        [0.5683],
        [0.5863],
        [0.4204],
        [0.5793],
        [0.6187],
        [0.5832],
        [0.5217],
        [0.5980],
        [0.4786],
        [0.5268],
        [0.5755],
        [0.5515],
        [0.5554],
        [0.5040],
        [0.5218],
        [0.6457],
        [0.4241],
        [0.4917],
        [0.3291],
        [0.5690],
        [0.5914],
        [0.5778],
        [0.4944],
        [0.5098]], grad_fn=<StackBackward0>)
Target y: tensor([0.9240, 0.3214, 0.7464, 0.6557, 0.3527, 0.4377, 0.6469, 0.7730, 0.1522,
        0.5738])
Epoch 003 | Train Loss: 0.1041 | Val Loss: 0.0934
EarlyStopping counter: 1 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.0605, 0.8212, 0.7840, 0.2831, 0.6659, 0.6184, 0.7256, 0.8576, 0.1748,
        0.0069, 0.3668, 0.0954, 0.8880, 0.3022, 0.0748, 0.6468, 0.0202, 0.7290,
        0.2421, 0.9770, 0.2213, 0.8875, 0.1115, 0.9575, 0.8476, 0.0283, 0.0416,
        0.5582, 0.7045, 0.1102, 0.9258, 0.8142])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.4244],
        [0.3783],
        [0.5754],
        [0.4348],
        [0.5376],
        [0.3785],
        [0.5115],
        [0.4360],
        [0.4621],
        [0.3636],
        [0.4282],
        [0.4969],
        [0.5017],
        [0.4170],
        [0.3862],
        [0.3694],
        [0.4281],
        [0.5488],
        [0.3519],
        [0.4355],
        [0.4720],
        [0.4010],
        [0.4731],
        [0.4376],
        [0.4601],
        [0.5078],
        [0.5252],
        [0.4226],
        [0.5805],
        [0.5329],
        [0.5907],
        [0.5919]], grad_fn=<StackBackward0>)
Target y: tensor([0.0605, 0.8212, 0.7840, 0.2831, 0.6659, 0.6184, 0.7256, 0.8576, 0.1748,
        0.0069])
Epoch 004 | Train Loss: 0.1034 | Val Loss: 0.0954
EarlyStopping counter: 2 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.1522, 0.1033, 0.6406, 0.0748, 0.1017, 0.0416, 0.7323, 0.7508, 0.0182,
        0.8916, 0.6788, 0.4457, 0.4961, 0.8663, 0.0202, 0.9428, 0.7045, 0.0510,
        0.1408, 0.3101, 0.4250, 0.9486, 0.2123, 0.1248, 0.7936, 0.0873, 0.1080,
        0.9591, 0.5509, 0.9258, 0.8476, 0.1638])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.3939],
        [0.4307],
        [0.3935],
        [0.4467],
        [0.5410],
        [0.4505],
        [0.5989],
        [0.4379],
        [0.5173],
        [0.4932],
        [0.4338],
        [0.5035],
        [0.5764],
        [0.4229],
        [0.4274],
        [0.3997],
        [0.5137],
        [0.4715],
        [0.4629],
        [0.4037],
        [0.4196],
        [0.4392],
        [0.5461],
        [0.4200],
        [0.4232],
        [0.4102],
        [0.4435],
        [0.4994],
        [0.4469],
        [0.4707],
        [0.5399],
        [0.6037]], grad_fn=<StackBackward0>)
Target y: tensor([0.1522, 0.1033, 0.6406, 0.0748, 0.1017, 0.0416, 0.7323, 0.7508, 0.0182,
        0.8916])
Epoch 005 | Train Loss: 0.0949 | Val Loss: 0.0935
EarlyStopping counter: 3 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.0796, 0.3867, 0.7203, 0.1522, 0.7459, 0.1080, 0.5270, 0.4902, 0.2459,
        0.8855, 0.3022, 0.1642, 0.2816, 0.7508, 0.8166, 0.7566, 0.2517, 0.0393,
        0.8663, 0.4912, 0.7906, 0.4763, 0.7179, 0.8393, 0.7643, 0.5509, 0.7074,
        0.7354, 0.7119, 0.1782, 0.4961, 0.0439])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.4703],
        [0.4961],
        [0.5230],
        [0.4633],
        [0.4173],
        [0.4424],
        [0.4280],
        [0.4540],
        [0.5172],
        [0.4883],
        [0.3663],
        [0.4025],
        [0.4363],
        [0.4366],
        [0.4562],
        [0.5327],
        [0.5909],
        [0.4617],
        [0.5130],
        [0.4489],
        [0.5131],
        [0.3609],
        [0.4737],
        [0.4858],
        [0.4724],
        [0.3997],
        [0.4374],
        [0.5304],
        [0.4494],
        [0.4643],
        [0.4149],
        [0.4383]], grad_fn=<StackBackward0>)
Target y: tensor([0.0796, 0.3867, 0.7203, 0.1522, 0.7459, 0.1080, 0.5270, 0.4902, 0.2459,
        0.8855])
Epoch 006 | Train Loss: 0.0948 | Val Loss: 0.0900
EarlyStopping counter: 4 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.8308, 0.8464, 0.6468, 0.7585, 0.1384, 0.8393, 0.4999, 0.1871, 0.3867,
        0.0988, 0.5227, 0.7119, 0.5446, 0.5333, 0.1642, 0.3974, 0.2479, 0.5818,
        0.3836, 0.1549, 0.7144, 0.2955, 0.9486, 0.8176, 0.2772, 0.0672, 0.8476,
        0.7643, 0.8085, 0.6659, 0.9258, 0.8513])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.5749],
        [0.6132],
        [0.5902],
        [0.4847],
        [0.4369],
        [0.6035],
        [0.4873],
        [0.5007],
        [0.5768],
        [0.4512],
        [0.4666],
        [0.6203],
        [0.3925],
        [0.3527],
        [0.5131],
        [0.5109],
        [0.5202],
        [0.4012],
        [0.4791],
        [0.4255],
        [0.5084],
        [0.5002],
        [0.3837],
        [0.3962],
        [0.5193],
        [0.4211],
        [0.6034],
        [0.5331],
        [0.3961],
        [0.3767],
        [0.4500],
        [0.4912]], grad_fn=<StackBackward0>)
Target y: tensor([0.8308, 0.8464, 0.6468, 0.7585, 0.1384, 0.8393, 0.4999, 0.1871, 0.3867,
        0.0988])
Epoch 007 | Train Loss: 0.0969 | Val Loss: 0.0905
EarlyStopping counter: 5 out of 5
Early stopping triggered

Final Test Results:
Loss: 0.1012
MAE: 0.2781
RMSE: 0.3183
Model saved to models/graphsage_root_probability_root_only_intermediate.pt

=== CLASS IMBALANCE DEBUG ===
Class 0: 193
Class 1: 207
torch.Size([400])
