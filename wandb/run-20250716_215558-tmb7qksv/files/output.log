Loaded datasets - Train: 400, Val: 50, Test: 50
=== DEBUG INFO ===
Sample data keys: ['name', 'max_path_length', 'mode', 'evidence_ids', 'num_nodes', 'num_edges', 'has_cycles', 'edge_index', 'root_node', 'leaf_nodes', 'edge_attr', 'intermediate_nodes', 'mask_strategy', 'x', 'y', 'evidence_vals']
Sample x shape: torch.Size([17, 17])
Sample y shape: torch.Size([1])
Sample y type: <class 'torch.Tensor'>
Sample y: tensor([0.0707])
Mode: root_probability
First 10 y shapes: [torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1])]

=== CLASS IMBALANCE DEBUG ===
Class 0: 193
Class 1: 207
Model config - Input: 17, Output: 1
Starting training...

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.4320, 0.7906, 0.8735, 0.8581, 0.7229, 0.5710, 0.6557, 0.1485, 0.7457,
        0.7921, 0.8513, 0.9191, 0.0748, 0.3452, 0.0285, 0.9428, 0.2244, 0.6716,
        0.7486, 0.1122, 0.0264, 0.5738, 0.9232, 0.6925, 0.8373, 0.7730, 0.1248,
        0.7622, 0.6420, 0.9486, 0.2322, 0.8168])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[ 0.2181],
        [ 0.0841],
        [ 0.0685],
        [ 0.0379],
        [ 0.0844],
        [ 0.1037],
        [ 0.0346],
        [ 0.0034],
        [ 0.0335],
        [ 0.0800],
        [ 0.1575],
        [ 0.0319],
        [ 0.1994],
        [ 0.0568],
        [ 0.0921],
        [ 0.0708],
        [ 0.0598],
        [ 0.1278],
        [-0.0153],
        [ 0.0909],
        [ 0.0316],
        [-0.0015],
        [ 0.1250],
        [ 0.1725],
        [ 0.1233],
        [ 0.1100],
        [ 0.0467],
        [ 0.0336],
        [ 0.1723],
        [-0.0621],
        [ 0.0824],
        [ 0.1586]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.5543],
        [0.5210],
        [0.5171],
        [0.5095],
        [0.5211],
        [0.5259],
        [0.5086],
        [0.5008],
        [0.5084],
        [0.5200],
        [0.5393],
        [0.5080],
        [0.5497],
        [0.5142],
        [0.5230],
        [0.5177],
        [0.5149],
        [0.5319],
        [0.4962],
        [0.5227],
        [0.5079],
        [0.4996],
        [0.5312],
        [0.5430],
        [0.5308],
        [0.5275],
        [0.5117],
        [0.5084],
        [0.5430],
        [0.4845],
        [0.5206],
        [0.5396]], grad_fn=<SigmoidBackward0>)
Epoch 001 | Train Loss: 0.1995 | Val Loss: 0.1338
Validation loss decreased (inf --> 0.133798).  Saving model ...

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.0262, 0.0179, 0.3855, 0.2677, 0.5333, 0.0182, 0.7290, 0.5337, 0.1442,
        0.0982, 0.0605, 0.2479, 0.0510, 0.2459, 0.4716, 0.1050, 0.5857, 0.0283,
        0.0748, 0.6557, 0.7566, 0.3974, 0.8149, 0.7683, 0.9756, 0.8375, 0.6574,
        0.1036, 0.2373, 0.8744, 0.1248, 0.0629])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.2301],
        [0.2438],
        [0.3830],
        [0.3300],
        [0.2447],
        [0.1523],
        [0.3345],
        [0.2033],
        [0.1183],
        [0.5800],
        [0.0769],
        [0.2933],
        [0.3268],
        [0.2906],
        [0.3563],
        [0.3709],
        [0.3619],
        [0.5228],
        [0.2456],
        [0.2788],
        [0.3653],
        [0.3149],
        [0.4353],
        [0.2039],
        [0.3710],
        [0.4611],
        [0.5073],
        [0.3044],
        [0.1827],
        [0.4464],
        [0.5276],
        [0.4355]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.5573],
        [0.5607],
        [0.5946],
        [0.5818],
        [0.5609],
        [0.5380],
        [0.5829],
        [0.5507],
        [0.5295],
        [0.6411],
        [0.5192],
        [0.5728],
        [0.5810],
        [0.5722],
        [0.5882],
        [0.5917],
        [0.5895],
        [0.6278],
        [0.5611],
        [0.5693],
        [0.5903],
        [0.5781],
        [0.6071],
        [0.5508],
        [0.5917],
        [0.6133],
        [0.6242],
        [0.5755],
        [0.5455],
        [0.6098],
        [0.6289],
        [0.6072]], grad_fn=<SigmoidBackward0>)
Epoch 002 | Train Loss: 0.1181 | Val Loss: 0.0875
Validation loss decreased (0.133798 --> 0.087500).  Saving model ...

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.9024, 0.8102, 0.5588, 0.4999, 0.9076, 0.2295, 0.1083, 0.9591, 0.4397,
        0.5818, 0.1562, 0.7077, 0.0855, 0.6986, 0.2284, 0.9264, 0.0982, 0.4790,
        0.8981, 0.1181, 0.6630, 0.0645, 0.1384, 0.3134, 0.8166, 0.8181, 0.7492,
        0.3214, 0.1248, 0.0120, 0.1191, 0.7045])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.4096],
        [0.5060],
        [0.3650],
        [0.3707],
        [0.4370],
        [0.2836],
        [0.4226],
        [0.1259],
        [0.5104],
        [0.3333],
        [0.5619],
        [0.6698],
        [0.7592],
        [0.2727],
        [0.6811],
        [0.8274],
        [0.3068],
        [0.7742],
        [0.3701],
        [0.4654],
        [0.5167],
        [0.3594],
        [0.7904],
        [0.6377],
        [0.6699],
        [0.6218],
        [0.2635],
        [0.8997],
        [0.7334],
        [0.8031],
        [0.7847],
        [0.5318]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.6010],
        [0.6239],
        [0.5902],
        [0.5916],
        [0.6075],
        [0.5704],
        [0.6041],
        [0.5314],
        [0.6249],
        [0.5826],
        [0.6369],
        [0.6615],
        [0.6812],
        [0.5678],
        [0.6640],
        [0.6958],
        [0.5761],
        [0.6844],
        [0.5915],
        [0.6143],
        [0.6264],
        [0.5889],
        [0.6879],
        [0.6542],
        [0.6615],
        [0.6506],
        [0.5655],
        [0.7109],
        [0.6755],
        [0.6906],
        [0.6867],
        [0.6299]], grad_fn=<SigmoidBackward0>)
Epoch 003 | Train Loss: 0.1212 | Val Loss: 0.1024
EarlyStopping counter: 1 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.2459, 0.7256, 0.7259, 0.1287, 0.5857, 0.5588, 0.2949, 0.0927, 0.4561,
        0.4457, 0.8981, 0.6409, 0.9240, 0.6889, 0.2885, 0.8366, 0.8212, 0.8476,
        0.1894, 0.4642, 0.7622, 0.9024, 0.0510, 0.1122, 0.4683, 0.1638, 0.5339,
        0.7087, 0.0069, 0.4204, 0.0530, 0.8149])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.5578],
        [0.5125],
        [0.9300],
        [0.7194],
        [0.7790],
        [0.3437],
        [0.2316],
        [0.4415],
        [0.5005],
        [0.3741],
        [0.2980],
        [0.4659],
        [0.6370],
        [0.5206],
        [0.6043],
        [0.7044],
        [0.3939],
        [0.4277],
        [1.0545],
        [0.4701],
        [0.5272],
        [0.5110],
        [0.3083],
        [0.4525],
        [0.5378],
        [0.6316],
        [0.6181],
        [0.6611],
        [0.3432],
        [0.4556],
        [0.1621],
        [0.4762]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.6359],
        [0.6254],
        [0.7171],
        [0.6725],
        [0.6855],
        [0.5851],
        [0.5576],
        [0.6086],
        [0.6226],
        [0.5925],
        [0.5740],
        [0.6144],
        [0.6541],
        [0.6273],
        [0.6466],
        [0.6692],
        [0.5972],
        [0.6053],
        [0.7416],
        [0.6154],
        [0.6288],
        [0.6250],
        [0.5765],
        [0.6112],
        [0.6313],
        [0.6528],
        [0.6498],
        [0.6595],
        [0.5850],
        [0.6120],
        [0.5404],
        [0.6168]], grad_fn=<SigmoidBackward0>)
Epoch 004 | Train Loss: 0.1172 | Val Loss: 0.1073
EarlyStopping counter: 2 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.2213, 0.9300, 0.9076, 0.8464, 0.6468, 0.0120, 0.9548, 0.5270, 0.6659,
        0.0982, 0.4303, 0.9608, 0.8864, 0.4764, 0.1569, 0.6744, 0.6630, 0.9893,
        0.1144, 0.7457, 0.2373, 0.1287, 0.4790, 0.1102, 0.0330, 0.8347, 0.7508,
        0.4457, 0.3454, 0.5738, 0.5422, 0.7045])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.3973],
        [0.3216],
        [0.2041],
        [0.1703],
        [0.4549],
        [0.5455],
        [0.4149],
        [0.4266],
        [0.4506],
        [0.3082],
        [0.6930],
        [0.3205],
        [0.3774],
        [0.3486],
        [0.4252],
        [0.5660],
        [0.3385],
        [0.3441],
        [0.4469],
        [0.4182],
        [0.2662],
        [0.3314],
        [0.5731],
        [0.4923],
        [0.5705],
        [0.3226],
        [0.4453],
        [0.6962],
        [0.6281],
        [0.2690],
        [0.4139],
        [0.4008]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.5980],
        [0.5797],
        [0.5508],
        [0.5425],
        [0.6118],
        [0.6331],
        [0.6023],
        [0.6051],
        [0.6108],
        [0.5764],
        [0.6666],
        [0.5794],
        [0.5933],
        [0.5863],
        [0.6047],
        [0.6378],
        [0.5838],
        [0.5852],
        [0.6099],
        [0.6031],
        [0.5662],
        [0.5821],
        [0.6395],
        [0.6206],
        [0.6389],
        [0.5800],
        [0.6095],
        [0.6673],
        [0.6521],
        [0.5668],
        [0.6020],
        [0.5989]], grad_fn=<SigmoidBackward0>)
Epoch 005 | Train Loss: 0.1077 | Val Loss: 0.0998
EarlyStopping counter: 3 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.4902, 0.2870, 0.0525, 0.4790, 0.2825, 0.2739, 0.0373, 0.6184, 0.8354,
        0.8916, 0.1356, 0.3919, 0.6742, 0.0645, 0.3582, 0.8347, 0.2152, 0.0120,
        0.7921, 0.8373, 0.5452, 0.0629, 0.1181, 0.1817, 0.8003, 0.7622, 0.6557,
        0.8112, 0.2373, 0.7749, 0.2586, 0.0579])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.3854],
        [0.4083],
        [0.3444],
        [0.3510],
        [0.6491],
        [0.3214],
        [0.2989],
        [0.4324],
        [0.5272],
        [0.3867],
        [0.3675],
        [0.4093],
        [0.4755],
        [0.3175],
        [0.6317],
        [0.3052],
        [0.4286],
        [0.3808],
        [0.7061],
        [0.4359],
        [0.4198],
        [0.4714],
        [0.5343],
        [0.1778],
        [0.5696],
        [0.3807],
        [0.3193],
        [0.3938],
        [0.4960],
        [0.4555],
        [0.7706],
        [0.4665]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.5952],
        [0.6007],
        [0.5853],
        [0.5869],
        [0.6568],
        [0.5797],
        [0.5742],
        [0.6064],
        [0.6288],
        [0.5955],
        [0.5909],
        [0.6009],
        [0.6167],
        [0.5787],
        [0.6529],
        [0.5757],
        [0.6055],
        [0.5941],
        [0.6695],
        [0.6073],
        [0.6034],
        [0.6157],
        [0.6305],
        [0.5443],
        [0.6387],
        [0.5940],
        [0.5792],
        [0.5972],
        [0.6215],
        [0.6119],
        [0.6836],
        [0.6145]], grad_fn=<SigmoidBackward0>)
Epoch 006 | Train Loss: 0.1122 | Val Loss: 0.1014
EarlyStopping counter: 4 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.5041, 0.7819, 0.0393, 0.9549, 0.9264, 0.2373, 0.9403, 0.8916, 0.5116,
        0.4269, 0.0069, 0.1505, 0.7035, 0.0510, 0.0645, 0.0717, 0.2213, 0.4999,
        0.8538, 0.3855, 0.8235, 0.1732, 0.8130, 0.0120, 0.0954, 0.2152, 0.7643,
        0.1748, 0.1894, 0.0120, 0.9191, 0.8176])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.3085],
        [0.6093],
        [0.5275],
        [0.5372],
        [0.3195],
        [0.3411],
        [0.4990],
        [0.4195],
        [0.5603],
        [0.3681],
        [0.3032],
        [0.4171],
        [0.5802],
        [0.3384],
        [0.3285],
        [0.4205],
        [0.4456],
        [0.5968],
        [0.3738],
        [0.3950],
        [0.4711],
        [0.5462],
        [0.5286],
        [0.5004],
        [0.7334],
        [0.4969],
        [0.4693],
        [0.4485],
        [0.3223],
        [0.3409],
        [0.4043],
        [0.5147]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.5765],
        [0.6478],
        [0.6289],
        [0.6312],
        [0.5792],
        [0.5845],
        [0.6222],
        [0.6034],
        [0.6365],
        [0.5910],
        [0.5752],
        [0.6028],
        [0.6411],
        [0.5838],
        [0.5814],
        [0.6036],
        [0.6096],
        [0.6449],
        [0.5924],
        [0.5975],
        [0.6156],
        [0.6333],
        [0.6292],
        [0.6226],
        [0.6755],
        [0.6217],
        [0.6152],
        [0.6103],
        [0.5799],
        [0.5844],
        [0.5997],
        [0.6259]], grad_fn=<SigmoidBackward0>)
Epoch 007 | Train Loss: 0.1097 | Val Loss: 0.1020
EarlyStopping counter: 5 out of 5
Early stopping triggered

Final Test Results:
Loss: 0.1198
MAE: 0.3032
RMSE: 0.3465
Model saved to models/graphsage_root_probability_both_intermediate.pt

=== CLASS IMBALANCE DEBUG ===
Class 0: 193
Class 1: 207
torch.Size([400])
