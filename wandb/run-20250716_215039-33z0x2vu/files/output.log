Loaded datasets - Train: 400, Val: 50, Test: 50
=== DEBUG INFO ===
Sample data keys: ['x', 'root_node', 'mode', 'name', 'max_path_length', 'leaf_nodes', 'evidence_vals', 'num_nodes', 'edge_index', 'has_cycles', 'edge_attr', 'evidence_ids', 'mask_strategy', 'intermediate_nodes', 'y', 'num_edges']
Sample x shape: torch.Size([17, 17])
Sample y shape: torch.Size([1])
Sample y type: <class 'torch.Tensor'>
Sample y: tensor([0.0707])
Mode: root_probability
First 10 y shapes: [torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1]), torch.Size([1])]

=== CLASS IMBALANCE DEBUG ===
Class 0: 193
Class 1: 207
Model config - Input: 17, Output: 1
Starting training...

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.8609, 0.7328, 0.6030, 0.2244, 0.8373, 0.4700, 0.8003, 0.0133, 0.4285,
        0.9428, 0.2955, 0.7119, 0.3230, 0.1732, 0.0223, 0.2772, 0.7337, 0.4961,
        0.1505, 0.5797, 0.8176, 0.7459, 0.9207, 0.4204, 0.8743, 0.6744, 0.0285,
        0.9423, 0.1369, 0.8389, 0.8168, 0.1442])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[ 0.0065],
        [ 0.0900],
        [-0.2247],
        [-0.1153],
        [ 0.0547],
        [-0.0833],
        [ 0.0592],
        [ 0.0887],
        [-0.0953],
        [-0.0357],
        [ 0.0048],
        [ 0.0782],
        [ 0.0162],
        [ 0.1459],
        [ 0.0712],
        [-0.2054],
        [ 0.1466],
        [ 0.0758],
        [ 0.1955],
        [-0.0579],
        [ 0.1274],
        [ 0.1067],
        [-0.0097],
        [-0.1214],
        [-0.0112],
        [ 0.0492],
        [-0.1216],
        [ 0.0047],
        [-0.0165],
        [ 0.1022],
        [-0.0777],
        [-0.1748]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.5016],
        [0.5225],
        [0.4441],
        [0.4712],
        [0.5137],
        [0.4792],
        [0.5148],
        [0.5222],
        [0.4762],
        [0.4911],
        [0.5012],
        [0.5196],
        [0.5040],
        [0.5364],
        [0.5178],
        [0.4488],
        [0.5366],
        [0.5190],
        [0.5487],
        [0.4855],
        [0.5318],
        [0.5267],
        [0.4976],
        [0.4697],
        [0.4972],
        [0.5123],
        [0.4696],
        [0.5012],
        [0.4959],
        [0.5255],
        [0.4806],
        [0.4564]], grad_fn=<SigmoidBackward0>)
Epoch 001 | Train Loss: 0.2053 | Val Loss: 0.0985
Validation loss decreased (inf --> 0.098465).  Saving model ...

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.1279, 0.0416, 0.7536, 0.4764, 0.6746, 0.2302, 0.0069, 0.0579, 0.0672,
        0.7824, 0.1036, 0.8663, 0.3214, 0.1441, 0.7749, 0.6469, 0.4700, 0.9655,
        0.0645, 0.2123, 0.6409, 0.1248, 0.5710, 0.8308, 0.2484, 0.7683, 0.7768,
        0.8149, 0.2213, 0.3296, 0.7542, 0.4716])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.3244],
        [0.4876],
        [0.1922],
        [0.4770],
        [0.5128],
        [0.2406],
        [0.3571],
        [0.3877],
        [0.2814],
        [0.5520],
        [0.5227],
        [0.4438],
        [0.3100],
        [0.7022],
        [0.5092],
        [0.4771],
        [0.3608],
        [0.3448],
        [0.5074],
        [0.4923],
        [0.3688],
        [0.2115],
        [0.2809],
        [0.4690],
        [0.2785],
        [0.5378],
        [0.2075],
        [0.4191],
        [0.6250],
        [0.2968],
        [0.4557],
        [0.2360]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.5804],
        [0.6195],
        [0.5479],
        [0.6170],
        [0.6255],
        [0.5599],
        [0.5883],
        [0.5957],
        [0.5699],
        [0.6346],
        [0.6278],
        [0.6092],
        [0.5769],
        [0.6687],
        [0.6246],
        [0.6171],
        [0.5892],
        [0.5854],
        [0.6242],
        [0.6207],
        [0.5912],
        [0.5527],
        [0.5698],
        [0.6151],
        [0.5692],
        [0.6313],
        [0.5517],
        [0.6033],
        [0.6513],
        [0.5737],
        [0.6120],
        [0.5587]], grad_fn=<SigmoidBackward0>)
Epoch 002 | Train Loss: 0.1194 | Val Loss: 0.0843
Validation loss decreased (0.098465 --> 0.084293).  Saving model ...

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.4269, 0.4716, 0.9486, 0.0223, 0.8130, 0.1307, 0.8067, 0.4790, 0.7803,
        0.9207, 0.1214, 0.3973, 0.0264, 0.7643, 0.5339, 0.0796, 0.7749, 0.2075,
        0.5227, 0.8375, 0.0228, 0.6268, 0.8855, 0.9756, 0.0283, 0.6406, 0.7921,
        0.4285, 0.0725, 0.7569, 0.1569, 0.8373])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.6161],
        [0.7095],
        [0.5156],
        [0.6320],
        [0.6567],
        [0.3402],
        [0.5986],
        [0.4144],
        [0.6801],
        [0.3485],
        [0.5566],
        [0.4553],
        [0.6754],
        [0.6800],
        [0.3358],
        [0.6934],
        [0.8202],
        [0.7429],
        [0.5511],
        [0.4875],
        [0.8741],
        [0.6076],
        [0.3828],
        [0.8105],
        [0.4081],
        [0.6650],
        [0.6794],
        [0.2854],
        [0.6705],
        [0.6409],
        [0.7372],
        [0.2299]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.6493],
        [0.6703],
        [0.6261],
        [0.6529],
        [0.6585],
        [0.5842],
        [0.6453],
        [0.6021],
        [0.6638],
        [0.5862],
        [0.6357],
        [0.6119],
        [0.6627],
        [0.6637],
        [0.5832],
        [0.6667],
        [0.6943],
        [0.6776],
        [0.6344],
        [0.6195],
        [0.7056],
        [0.6474],
        [0.5946],
        [0.6922],
        [0.6006],
        [0.6604],
        [0.6636],
        [0.5709],
        [0.6616],
        [0.6550],
        [0.6764],
        [0.5572]], grad_fn=<SigmoidBackward0>)
Epoch 003 | Train Loss: 0.1129 | Val Loss: 0.0887
EarlyStopping counter: 1 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.7328, 0.7087, 0.2946, 0.0120, 0.7824, 0.0672, 0.5818, 0.9240, 0.0373,
        0.4377, 0.5739, 0.0796, 0.7256, 0.1638, 0.6316, 0.0182, 0.4683, 0.5227,
        0.8112, 0.3367, 0.5738, 0.8618, 0.4320, 0.6889, 0.4999, 0.7290, 0.0330,
        0.6030, 0.7035, 0.5857, 0.5452, 0.3454])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.2802],
        [0.5739],
        [0.5798],
        [0.5591],
        [0.4746],
        [0.2458],
        [0.5094],
        [0.5666],
        [0.4441],
        [0.6263],
        [0.3097],
        [0.4472],
        [0.4035],
        [0.3118],
        [0.3300],
        [0.4447],
        [0.3617],
        [0.4544],
        [0.4788],
        [0.5396],
        [0.3915],
        [0.4815],
        [0.4093],
        [0.4351],
        [0.4363],
        [0.6646],
        [0.5556],
        [0.2643],
        [0.4170],
        [0.6323],
        [0.4481],
        [0.2256]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.5696],
        [0.6397],
        [0.6410],
        [0.6362],
        [0.6165],
        [0.5611],
        [0.6247],
        [0.6380],
        [0.6092],
        [0.6516],
        [0.5768],
        [0.6100],
        [0.5995],
        [0.5773],
        [0.5818],
        [0.6094],
        [0.5894],
        [0.6117],
        [0.6175],
        [0.6317],
        [0.5966],
        [0.6181],
        [0.6009],
        [0.6071],
        [0.6074],
        [0.6603],
        [0.6354],
        [0.5657],
        [0.6028],
        [0.6530],
        [0.6102],
        [0.5562]], grad_fn=<SigmoidBackward0>)
Epoch 004 | Train Loss: 0.1026 | Val Loss: 0.0896
EarlyStopping counter: 2 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.8112, 0.7542, 0.1185, 0.0982, 0.8981, 0.2597, 0.7622, 0.2955, 0.9591,
        0.3774, 0.7683, 0.5227, 0.6943, 0.3919, 0.8235, 0.1356, 0.6746, 0.9549,
        0.1122, 0.8166, 0.7045, 0.1569, 0.0645, 0.9024, 0.7936, 0.9635, 0.1191,
        0.9240, 0.6406, 0.0228, 0.3847, 0.7119])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.2602],
        [0.4942],
        [0.3766],
        [0.3951],
        [0.6008],
        [0.4355],
        [0.2679],
        [0.5374],
        [0.4924],
        [0.4801],
        [0.4918],
        [0.5637],
        [0.3043],
        [0.5241],
        [0.4477],
        [0.3603],
        [0.5619],
        [0.4873],
        [0.2546],
        [0.5259],
        [0.5072],
        [0.3898],
        [0.2514],
        [0.5953],
        [0.4321],
        [0.4788],
        [0.3847],
        [0.4377],
        [0.5203],
        [0.4323],
        [0.2863],
        [0.3437]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.5647],
        [0.6211],
        [0.5931],
        [0.5975],
        [0.6458],
        [0.6072],
        [0.5666],
        [0.6312],
        [0.6207],
        [0.6178],
        [0.6205],
        [0.6373],
        [0.5755],
        [0.6281],
        [0.6101],
        [0.5891],
        [0.6369],
        [0.6195],
        [0.5633],
        [0.6285],
        [0.6241],
        [0.5962],
        [0.5625],
        [0.6446],
        [0.6064],
        [0.6175],
        [0.5950],
        [0.6077],
        [0.6272],
        [0.6064],
        [0.5711],
        [0.5851]], grad_fn=<SigmoidBackward0>)
Epoch 005 | Train Loss: 0.1080 | Val Loss: 0.0860
EarlyStopping counter: 3 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.1083, 0.4700, 0.7566, 0.7397, 0.9655, 0.0605, 0.7259, 0.2831, 0.8166,
        0.3867, 0.8168, 0.0120, 0.1999, 0.0855, 0.8373, 0.8082, 0.0525, 0.4884,
        0.4269, 0.9635, 0.4486, 0.5857, 0.0873, 0.1191, 0.5333, 0.7074, 0.1279,
        0.8663, 0.4747, 0.3973, 0.0389, 0.3275])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.5820],
        [0.4729],
        [0.5442],
        [0.3968],
        [0.4228],
        [0.4190],
        [0.5101],
        [0.4885],
        [0.6162],
        [0.4998],
        [0.5691],
        [0.5984],
        [0.5587],
        [0.6103],
        [0.2087],
        [0.5673],
        [0.4218],
        [0.5555],
        [0.5835],
        [0.5258],
        [0.5166],
        [0.6357],
        [0.4136],
        [0.5462],
        [0.4356],
        [0.4731],
        [0.3168],
        [0.5732],
        [0.4059],
        [0.5597],
        [0.5520],
        [0.5219]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.6415],
        [0.6161],
        [0.6328],
        [0.5979],
        [0.6042],
        [0.6032],
        [0.6248],
        [0.6198],
        [0.6493],
        [0.6224],
        [0.6385],
        [0.6453],
        [0.6361],
        [0.6480],
        [0.5520],
        [0.6382],
        [0.6039],
        [0.6354],
        [0.6419],
        [0.6285],
        [0.6264],
        [0.6538],
        [0.6020],
        [0.6333],
        [0.6072],
        [0.6161],
        [0.5785],
        [0.6395],
        [0.6001],
        [0.6364],
        [0.6346],
        [0.6276]], grad_fn=<SigmoidBackward0>)
Epoch 006 | Train Loss: 0.1039 | Val Loss: 0.0871
EarlyStopping counter: 4 out of 5

=== BATCH DEBUG 0 ===
Batch size: 32
Total nodes in batch: 544
Data y shape: torch.Size([32])
Data y: tensor([0.3668, 0.2152, 0.1442, 0.7508, 0.2459, 0.8197, 0.0330, 0.7967, 0.1999,
        0.0393, 0.7459, 0.0645, 0.2479, 0.8609, 0.9264, 0.8393, 0.3549, 0.0580,
        0.8855, 0.0525, 0.4486, 0.7087, 0.3919, 0.7067, 0.6597, 0.4902, 0.7683,
        0.4397, 0.2302, 0.1853, 0.2213, 0.4763])
Unique batch indices: tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])
Root nodes: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0])
Model output shape: torch.Size([32, 1])
Model output: tensor([[0.4647],
        [0.5334],
        [0.4503],
        [0.4994],
        [0.6049],
        [0.4662],
        [0.5231],
        [0.4171],
        [0.4036],
        [0.4138],
        [0.4339],
        [0.3611],
        [0.6090],
        [0.6098],
        [0.5500],
        [0.5959],
        [0.6704],
        [0.3886],
        [0.4998],
        [0.6039],
        [0.4453],
        [0.4242],
        [0.4726],
        [0.4564],
        [0.5235],
        [0.5987],
        [0.5416],
        [0.4445],
        [0.3418],
        [0.5238],
        [0.4355],
        [0.4473]], grad_fn=<StackBackward0>)
Model output (sigmoid probabilities): tensor([[0.6141],
        [0.6303],
        [0.6107],
        [0.6223],
        [0.6468],
        [0.6145],
        [0.6279],
        [0.6028],
        [0.5995],
        [0.6020],
        [0.6068],
        [0.5893],
        [0.6477],
        [0.6479],
        [0.6341],
        [0.6447],
        [0.6616],
        [0.5960],
        [0.6224],
        [0.6465],
        [0.6095],
        [0.6045],
        [0.6160],
        [0.6122],
        [0.6280],
        [0.6453],
        [0.6322],
        [0.6093],
        [0.5846],
        [0.6280],
        [0.6072],
        [0.6100]], grad_fn=<SigmoidBackward0>)
Epoch 007 | Train Loss: 0.0984 | Val Loss: 0.0874
EarlyStopping counter: 5 out of 5
Early stopping triggered

Final Test Results:
Loss: 0.0953
MAE: 0.2694
RMSE: 0.3087
Model saved to models/graphsage_root_probability_both_intermediate.pt

=== CLASS IMBALANCE DEBUG ===
Class 0: 193
Class 1: 207
torch.Size([400])
